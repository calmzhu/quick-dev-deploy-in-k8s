input {
  kafka {
      decorate_events => true
      bootstrap_servers => "10.103.181.104:9092"
      topics => ["gitlab"]
  }
}

filter {
    mutate {
        copy => { 
            "[@metadata][kafka][topic]" => "topic"
            "[@metadata][kafka][key]" => "key"
        }
    }
    json {
        source => "message"
    }    
}

output {
  elasticsearch {
    hosts => ["https://10.98.187.62:9200"]
    index => "gitlab_events"
    user => "elastic"
    password => "qbkbqf49qvx2cgb9v42ps5mw"
    ssl_certificate_verification => false
    ssl => true
    cacert => "/usr/share/logstash/ca-certs/ca.pem"
  }
}
